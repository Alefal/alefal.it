<ion-header>
  <ion-navbar color="primary">
    <ion-title>Ordine</ion-title>

    <ion-buttons end>
      <button ion-button icon-only (click)="dismiss()">
        <ion-icon ios="ios-close" md="md-close"></ion-icon>
      </button>
    </ion-buttons>

  </ion-navbar>
</ion-header>

<ion-content>
	
    <!-- CREATE: Client and Products -->
    <ion-list *ngIf="sectionCreate">
      <ion-item>
        <ion-label>Cliente *</ion-label>
        <ion-select [(ngModel)]="selectedUser" cancelText="Chiudi" okText="Scegli cliente" required>
          <ion-option *ngFor="let cust of customer" [value]="cust.user_email">{{cust.display_name}}</ion-option>
        </ion-select>
      </ion-item>

      <ion-item>
        <ion-label>Prodotti *</ion-label>
        <ion-select [(ngModel)]="selectedProducts" multiple="true" cancelText="Chiudi" okText="Scegli prodotti"required>
          <ion-option *ngFor="let prod of line_items" [value]="prod">{{prod.title}}</ion-option>
        </ion-select>
      </ion-item>
    </ion-list>
    <button *ngIf="sectionCreate" ion-button large full color="dark" (click)="orderStepAddQuantity()">Avanti</button>

    <!-- CREATE: Products Quantity -->
    <ion-list *ngIf="sectionSelectQuantity">
      <ion-item *ngFor="let prod of selectedProductsQnt">
        <ion-label>
          {{prod.prodTitle}}
        </ion-label>
        <ion-input type="number" name="prodAddQuantity" [(ngModel)]="prod.prodAddQuantity"></ion-input>
        <ion-note item-right>
          <em>{{prod.prodQuantity}}</em>
        </ion-note>
      </ion-item>
    </ion-list>
    <button *ngIf="sectionSelectQuantity" ion-button large full color="dark" (click)="orderStepSummary()">Riepilogo</button>

    <!-- CREATE: Summary -->
    <ion-list *ngIf="sectionSummary">
      <ion-item>
        <p>Cliente</p>
        <h2>{{selectedUser}}</h2>
      </ion-item>

      <ion-item *ngFor="let prod of selectedProductsQnt">
        <h2>{{prod.prodAddQuantity}} x {{prod.prodTitle}}</h2>
        <ion-note item-right>
          <em>&euro; {{prod.prodAddQuantity * prod.prodPrice}}</em>
        </ion-note>
      </ion-item>
    </ion-list>
    <button *ngIf="sectionSummary" ion-button large full color="dark" (click)="orderComplete()">Completa</button>

    <!-- DETAIL: ... -->
    <form (ngSubmit)="saveOrder(ordine)" *ngIf="sectionDetail">
      <ion-list>
        <ion-item>
          <p>Cliente</p>
          <h2>{{ordine.customer.first_name}}</h2>
        </ion-item>

        <ion-item>
          <p>Totale</p>
          <h2>{{ordine.total}}</h2>
        </ion-item>
      </ion-list>
      <button ion-button large full color="dark" type="submit">Salva Ordine</button>
    </form>


    <div *ngIf="showButtonEditDelete">
      <ion-fab right bottom>
        <button ion-fab color="dark"><ion-icon name="ios-arrow-back"></ion-icon></button>
        <ion-fab-list side="left">
          <button ion-fab color="dark" (click)="sendMail(ordine.customer.email)"><ion-icon name="mail"></ion-icon></button>
          <button ion-fab color="dark" (click)="changeStatus(ordine.id,ordine.status)"><ion-icon name="swap"></ion-icon></button>
          <button ion-fab color="dark" (click)="deleteOrder(ordine.id)"><ion-icon name="trash"></ion-icon></button>
        </ion-fab-list>
      </ion-fab>
  </div>


</ion-content>