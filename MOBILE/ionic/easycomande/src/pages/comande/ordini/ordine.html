<ion-header>
  <ion-navbar color="dark">
    <ion-buttons left>
      <button ion-button icon-only (click)="dismiss()">
        <ion-icon ios="ios-close" md="md-close"></ion-icon>
      </button>
    </ion-buttons>

    <ion-title>{{ordine?.client}}</ion-title>
  </ion-navbar>
</ion-header>

<ion-content>

  <ion-fab top right edge>
    <button ion-fab mini color="dark"><ion-icon name="ios-arrow-down"></ion-icon></button>
    <ion-fab-list>
      <button *ngIf="ordine?.state != 'completed'" ion-fab (click)="editOrder(ordine)"><ion-icon name="create"></ion-icon></button>
      <!--
      <button *ngIf="ordine?.state != 'completed'" ion-fab (click)="addNote(ordine.id)"><ion-icon name="list"></ion-icon></button>
      -->
      <button ion-fab (click)="changeOrderState(ordine.notes)"><ion-icon name="checkbox-outline"></ion-icon></button>
      <button ion-fab (click)="showNote(ordine.notes)"><ion-icon name="eye"></ion-icon></button>
      <button ion-fab (click)="deleteOrder(ordine.id)"><ion-icon name="trash"></ion-icon></button>
    </ion-fab-list>
  </ion-fab>
  
  <ion-list>

    <ion-item>
      <h3>Ordine per <strong>{{ ordine?.client }}</strong></h3>
    </ion-item>

    <ion-item>
      <p>Eseguito il</p>
      <h2>{{ ordine?.date | date : 'dd/MM, HH:mm' }}</h2>
    </ion-item>

    <ion-item>
      <p>Totale</p>
      <h2>{{ ordine?.totalorder }}</h2>
    </ion-item>

    <ion-item *ngIf="ordine?.totalservice">
      <p>Servizio</p>
      <h2>{{ ordine?.totalservice }}</h2>
    </ion-item>

    <ion-item *ngIf="ordine?.items.length > 0">
      <!--
      <p>Prodotti</p>
      <h3><strong>{{ordine.total_line_items_quantity}}</strong> prodotto/i acquistato/i</h3>
      -->
      <p>Piatti da menu</p>
      <ion-icon name="menu" item-right></ion-icon>
    </ion-item>

    <ion-item *ngFor="let prod of ordine?.items">
      <ion-icon *ngIf="ordine?.state != 'completed' && prod.state != 'completed'" name="remove-circle" color="danger" item-left (click)="deleteProduct(prod.id,ordine.id)"></ion-icon>
      <ion-icon *ngIf="ordine?.state != 'completed' && prod.state != 'completed'" name="checkbox-outline" color="dark" item-left (click)="changeItemState(prod.id,ordine.id)"></ion-icon>
      <ion-icon *ngIf="ordine?.state == 'completed' || prod.state == 'completed'" name="checkmark" color="secondary" item-left></ion-icon>
      <h2>{{prod.quantity}} x {{prod.name}}</h2>

      <ion-card class="prodMetaCard" >
        <ion-card-content *ngIf="prod.note != ''">
          <ion-row>
            <ion-col class="prodMeta">
              {{prod.note}}
            </ion-col>
          </ion-row>
        </ion-card-content>
      </ion-card>

      <ion-note item-right>
        <em>&euro; {{prod.quantity * prod.price}}</em>
      </ion-note>
    </ion-item>

    <ion-item *ngIf="ordine?.specials.length > 0">
      <p>Piatti speciali</p>
      <ion-icon name="restaurant" item-right></ion-icon>
    </ion-item>

    <ion-item *ngFor="let special of ordine?.specials">
      <ion-icon *ngIf="ordine?.state != 'completed' && special.state != 'completed'" name="remove-circle" color="danger" item-left (click)="deleteSpecial(special.id,ordine.id)"></ion-icon>
      <ion-icon *ngIf="ordine?.state != 'completed' && special.state != 'completed'" name="checkbox-outline" color="dark" item-left (click)="changeSpecialState(prod.id,ordine.id)"></ion-icon>
      <ion-icon *ngIf="ordine?.state == 'completed' || special.state == 'completed'" name="checkmark" color="secondary" item-left></ion-icon>
      <h2>{{special.name}}</h2>

      <ion-card class="prodMetaCard" >
        <ion-card-content *ngIf="special.note != ''">
          <ion-row>
            <ion-col class="prodMeta">
              {{special.note}}
            </ion-col>
          </ion-row>
        </ion-card-content>
      </ion-card>

      <ion-note item-right>
        <em>&euro; {{special.price}}</em>
      </ion-note>
    </ion-item>

  </ion-list>

  <!--
  <div>
    <ion-fab right top>
      <button ion-fab color="dark"><ion-icon name="ios-arrow-back"></ion-icon></button>
      <ion-fab-list side="left">
        <button ion-fab color="dark" (click)="sendMail(ordine.customer.email)"><ion-icon name="mail"></ion-icon></button>
        <button ion-fab color="dark" (click)="changeStatus(ordine,ordine.status)"><ion-icon name="swap"></ion-icon></button>
        <button ion-fab color="dark" (click)="deleteOrder(ordine.id)"><ion-icon name="trash"></ion-icon></button>
        <button ion-fab color="dark" (click)="showNote(ordine.id)"><ion-icon name="paper"></ion-icon></button>
      </ion-fab-list>
    </ion-fab>
  </div>
  -->

</ion-content>

<!--
<ion-footer>
  <ion-navbar color="primary">
    <ion-title>Gestione</ion-title>

    <ion-buttons end>
      <button ion-button icon-only (click)="deleteOrder(ordine.id)"><ion-icon name="trash"></ion-icon></button>
      <button ion-button icon-only (click)="showNote(ordine.id)"><ion-icon name="create"></ion-icon></button>
    </ion-buttons>

  </ion-navbar>
</ion-footer>
-->